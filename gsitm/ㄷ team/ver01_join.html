<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <title>피트니스 회원가입</title>

</head>
<body>
  
  <h3>회원가입</h3>
  <form name ="f2">
    <label for="id"><b>아이디</b>를 입력하세요</label><br>
    <input type="text" id="id">
    <input type="button" id="idcheck" onclick = 'idcheck_click()' name="clicked_id" value="ID중복확인"><br><br>
    <label for="pw1"><b>비밀번호</b>를 입력하세요</label><br>
    <input type="password" id="pw1"><br><br>
    <label for="pw2"><b>비밀번호 확인</b></label><br>
    <input type="password" id="pw2">
    <input type="button" id="pwcheck" onclick = 'pwcheck_click()' name="clicked_pw" value="비밀번호 확인"><br><br>
    <label for="name"><b>성명</b>을 입력하세요</label><br>
    <input type="text" id="name" maxlength="10"><br><br>
    <label for="contact"><b>연락처</b>를 입력하세요</label><br>
    <input type="tel" id="contact" placeholder="010-1234-5678" pattern="[0-9]{3}-[0-9]{2}-[0-9]{3}" required><br><br>
    <label for="age"><b>나이</b>를 입력하세요</label><br>
    <input type="text" id="age" maxlength="3"><br><br>
    <b>성별</b>을 입력하세요 <br>
    <select id="gender">
      <option value="">-- 선택 --</option>
      <option value="남자">남자</option>
      <option value="여자">여자</option>
    </select><br><br>
    <label for="address"><b>주소</b>를 입력하세요</label><br>
    <input type="text" id="address"><br><br>
    <input type="button" id="button1" onclick= 'button1_click()' name="clicked_id" value="가입하기">
    
  </form>
</body>
<script>

  function idcheck_click() {
    var key = Object.keys(localStorage);
    var localID = document.getElementById("id").value;
    for(i=0;i<localStorage.length;i++){
    var aaa=JSON.parse(localStorage.getItem(key[0]));
    console.log(aaa.age);
    }

    if(localID===null || localID===""){
      alert("아이디를 입력해 주세요.");
      return;
    }





    for(let i = 0; i < key.length;i++){
      if (key[i]!=="__user__"){
        if("__user__"+localID === key[i]){
            alert("이미 가입된 아이디가 존재합니다.");
            return;

        }else {
          document.getElementById("idcheck").value="확인완료";
        }
      }
    }
  }

  function pwcheck_click(){

    var pw1 = document.getElementById('pw1').value;

    var pw2 = document.getElementById('pw2').value;

    if(pw1 != pw2){
      alert("비밀번호가 일치하지 않습니다.");
      document.f2.pw2.focus();
      return false;
    } else{
      alert("비밀번호가 일치합니다.");
      return true;
    }
  }






  function button1_click(){

    var name = document.getElementById('name').value;
   
    var contact = document.getElementById('contact').value;
  
    var id = document.getElementById('id').value;
   
    var pw1 = document.getElementById('pw1').value;
   
    var pw2 = document.getElementById('pw2').value;

    var age = document.getElementById('age').value;
    
    var gender = document.getElementById('gender').value;
    
    var address = document.getElementById('address').value;
   

    var userkey = '__user__' + id;
    var userInfo = {
      name: name,
      contact: contact,
      id: id,
      pw1: pw1,
      age: age,
      gender: gender,
      rank:1
    }

    if(id==""){
        alert("아이디를 입력해주세요.");
        document.f2.id.focus();
        return;
    }

    if(pw1==""){
        alert("비밀번호를 입력해주세요.");
        document.f2.pw1.focus();
        return;
    }

    if(pw2==""){
        alert("비밀번호를 확인해주세요.");
        document.f2.pw2.focus();
        return;
    }

    if(name==""){
        alert("성명을 입력해주세요.");
        document.f2.name.focus();
        return;
    }

    if(contact==""){
        alert("연락처를 입력해주세요.");
        document.f2.contact.focus();
        return;
    }

    if(age==""){
        alert("나이를 입력해주세요.");
        document.f2.age.focus();
        return;
    }

    if(age < 14 || age > 124){
        alert("정상적인 나이를 입력해주세요.");
        document.f2.age.focus();
        return;
    }

    if(address==""){
        alert("주소를 입력해주세요.");
        document.f2.address.focus();
        return;
    }
    

    
    //저장값을 한줄로
    console.log(userInfo);
    localStorage.setItem(userkey, JSON.stringify(userInfo));

    // -----
    location.href="ver01_login.html";

  }
  
    localStorage.setItem(document.getElementById('name').value, document.getElementById('name').value);
        
      
    
  
</script>
</html>